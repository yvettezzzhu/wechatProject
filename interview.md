1. promise
promise用来解决回调地狱，层层嵌套，容易搞混，不方便阅读的问题
回调地狱是因为异步函数，也就是宏任务独立于同步函数主线程。
主线程中，执行着同步函数，发现里面有异步函数，放到宏任务中，继续执行同步函数，这样就不用等异步函数执行完成回调了，可以继续往下执行。

但是，有的时候，我们是需要回调拿到的数据，才能进行执行下一步的函数。
因此，不能跳出回调函数，得在里面再嵌套一层。一层一层嵌套，就出现了回调地狱。

promise因为有三个状态，pending初始化即是new promise后，resolve或reject之前的，fulfilled对应是resolve操作成功，rejected对应的是reject操作失败
promise搭配then使用，可以实现拿到回调的数据，再进行下一步函数，不用嵌套到内部。
2个回调函数，用promise+then，如果3个及以上的回调函数，前面的then要return new Promise(),才能继续传递

微信小程序的登录涉及多个回调函嵌套，云函数获取appid和AppSecret，请求微信url获取openid，云函数上传用户数据，就可以用promise两个then

2.宏任务和微任务
主线程上的异步函数产生宏任务，比如：setTimeout，回调函数等
promise后的then产生的是微任务
同级里微任务先于宏任务执行

要注意的是宏任务里嵌套了微任务，这样还是宏任务先执行，因为只有先执行了宏任务，才会产生微任务，微任务才能执行